---
title: "PSY6422 Project"
format: html
editor: visual
execute:
  echo: true
  warning: false
  message: false
---

# Is Wales wetter than England? ðŸ’§

## Data Origin

The rainfall data used in this project was sourced from the [Met Office website](https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-and-regional-series) which provides long-term climate records for each UK region. The data set used is the Year Ordered Statistics, which contains monthly and annual rainfall values derived from weather station observations across the UK.

For this project, the Year Ordered Statistics was filtered to the regions England and Wales, with rainfall (mm) selected as the measured parameter.

The following regional rainfall records were downloaded directly from the Met Office:

Total rainfall for Wales (1836-2025): [Wales rainfall data (Wales.txt)](https://www.metoffice.gov.uk/pub/data/weather/uk/climate/datasets/Rainfall/date/Wales.txt)

Total rainfall for England (1836-2025): [England rainfall data (England.txt)](https://www.metoffice.gov.uk/pub/data/weather/uk/climate/datasets/Rainfall/date/England.txt)

### Research Question

This project investigates whether Wales receives higher average annual rainfall than England, using annual rainfall totals (mm) as the definition of "wetter". The analysis covers a 189 year period (1836-2025), allowing long-term climate patterns and regional differences to be explored.

# Data Preparation

```{r}
#load required packages for data manipulation

library(tidyverse)
library(ggplot2)
library(dplyr)
library(gganimate)
```

```{r}
#load in the data

Wales_data <- read.table("https://www.metoffice.gov.uk/pub/data/weather/uk/climate/datasets/Rainfall/date/Wales.txt", skip = 5, header = TRUE, fill = TRUE)
England_data <- read.table("https://www.metoffice.gov.uk/pub/data/weather/uk/climate/datasets/Rainfall/date/England.txt", skip=5, header = TRUE, fill = TRUE)

```

```{r}
#view data to see what headings there are

head(Wales_data)
head(England_data)
```

We can see an annual column is included in both data sets. This is the best column to use for this research question.

```{r}
#check for any missing values in annual column
sum(is.na(Wales_data$ann))
sum(is.na(England_data$ann))

#check which year annual data is missing from
Wales_data %>% 
  filter(is.na(ann)) %>% 
  select(year)

England_data %>% 
  filter(is.na(ann)) %>% 
  select(year)
```

From running this analysis, the current data shows information missing from the year 2025. This may vary depending on when this analysis is ran. To accommodate for this, filter the data by removing missing data in annual instead of removing the specific year data is missing from.

```{r}
#clean the data by removing missing items (will vary each year) and include country column
clean_rainfall <- function(data, country) {
  data %>%
    select(year, ann) %>%
    filter(!is.na(ann)) %>% #removing missing data in annual
    mutate(Country = country) #including country column here
}

Wales_clean <- clean_rainfall(Wales_data, "Wales")
England_clean <- clean_rainfall(England_data, "England")
```

```{r}
#Combining the clean data
combined <- rbind(Wales_clean, England_clean)

#View combined clean data
view(combined)
```

## Visualisation 1

```{r}
# bar graph to compare average annual rainfall
avg_rain <- combined %>%
  group_by(Country) %>%
  summarise(MeanRainfall = mean(ann, na.rm = TRUE))

ggplot(avg_rain, aes(x = Country, y = MeanRainfall, fill = Country)) +
  geom_col() +
  scale_fill_manual(values = c("Wales" = "darkblue", "England" = "lightblue")) +  # colours set here
  labs(
    title = "Average Annual Rainfall Comparison",
    subtitle = "Is Wales wetter than England overall?",
    y = "Mean Rainfall (mm)"
  ) +
  theme_minimal(base_size = 10) 
```

This graph shows that Wales receives substantially more rainfall than England overall. England's mean rainfall is under 900mm, while Wales exceeds 1400mm. The clear difference indicates that Wales is noticeable wetter on average. However, this does not show rainfall for each year in the data, only an average, so a scatter plot is required for the final visualisation.

## Final Visualisation

```{r}

#create animated scatter plot
animated_raindrops <- combined %>%
  ggplot(aes(x = year, y = ann, colour = Country)) +
  geom_point(shape = "ðŸ’§", size = 5) +
  scale_colour_manual(values = c("Wales" = "darkblue", "England" = "lightblue")) +
  labs(
    title = "Rainfall in Wales and England",
    subtitle = "Year: {frame_time}",
    y = "Rainfall (mm)"
  ) +
  transition_time(year) +
  shadow_mark() +
  theme_minimal(base_size = 14)
```

![](rainfall_animation.gif)

This graph provides clear evidence in relation to the research question 'Is Wales wetter than England?'. Across the entire period shown, Wales consistently records far higher annual rainfall than England, with no years in which England approaches Welsh rainfall levels. The clear separation between the two clusters of points show that Wales is reliably and substantially wetter than England.

# Summary

## Future Directions

This data provided a useful high level comparison of rainfall patterns between England and Wales, but its reliance on national averages limits how much detail can be inferred about local variation such as coastal versus inland climates or mountainous versus lowland areas. Another limitation is the reliance on the monitoring stations and what they contribute to the national figures. If station density differs between countries, or if certain regions are under represented, this could introduce subtle biases into the averages.

With additional time or richer data, the analysis could be extended to include variables such as elevation, distance from the coast or regional breakdowns. These additions would help reveal how geography and seasonal effects shape rainfall patterns more precisely.

## Conclusion

From this analysis, it is clear that Wales receives more annual rainfall than England on average, reflecting known climatic differences between the two countries. Visualising the time series helped show not only this overall difference but also the year-to-year variability in rainfall. These fluctuations highlight the value of visualisation in distinguishing long term tendencies from short term natural variability.

Overall, the findings reinforce the general understanding that Wales is typically wetter than England, while also illustrating the importance of considering data resolution, potential biases, and regional context when interpreting national level statistics.
